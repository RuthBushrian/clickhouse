name: Run ClickHouse SQL Scripts

on:
  push:
    branches:
      - main  # Change this to your main branch

jobs:
  run-sql:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout Repository
      uses: actions/checkout@v2

    - name: Add the ClickHouse APT Repository
      run: |
        sudo apt install apt-transport-https
        sudo sh -c 'echo "deb http://repo.clickhouse.tech/deb/stable/ main/" > /etc/apt/sources.list.d/clickhouse.list'
        sudo apt-key adv --keyserver keyserver.ubuntu.com --recv E0C56BD4

    - name: Install ClickHouse Client
      run: |
        sudo apt update
        sudo apt install clickhouse-client
        clickhouse-client --version

    # - name: Run SQL Scripts
    #   run: |
    #     for file in ./sql/*.sql; do
    #       clickhouse-client --host gns0hl2of0.us-east-1.aws --port 8443 --user default --password dQmdvuZ8Isw~t --query "$(cat $file)"
    #     done

      # working-directory: $GITHUB_WORKSPACE